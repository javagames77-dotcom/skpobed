<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Тест Webhook</title>
<style>
  body { font-family: Arial; padding: 40px; background:#f5f5f5; }
  pre { background:#000; color:#0f0; padding:15px; overflow:auto; }
  .error { color:red; margin-top:20px; }
</style>
</head>
<body>

<h1>Тест Webhook</h1>

<button onclick="loadData()">Загрузить</button>

<h3>Сырой ответ:</h3>
<pre id="raw"></pre>

<h3>Список имён:</h3>
<ul id="list"></ul>

<div id="error" class="error"></div>

<script>
async function loadData() {
  const raw = document.getElementById("raw");
  const list = document.getElementById("list");
  const errorBox = document.getElementById("error");

  raw.textContent = "";
  list.innerHTML = "";
  errorBox.textContent = "";

  try {
    const response = await fetch(
      "https://primary-production-4b93e.up.railway.app/webhook-test/api"
    );

    raw.textContent = "HTTP статус: " + response.status;

    const text = await response.text();
    raw.textContent += "\n\n" + text;

    const data = JSON.parse(text);

    data.forEach(item => {
      const li = document.createElement("li");
      li.textContent = item.name;
      list.appendChild(li);
    });

  } catch (err) {
    errorBox.textContent = "Ошибка: " + err.message;
    raw.textContent = "Fetch упал полностью (скорее всего CORS)";
    console.error(err);
  }
}
</script>

</body>
</html>
